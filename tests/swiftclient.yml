---

#
# Run some tests using swift client
# 

- name: check if curtisrc exists
  stat: path=/home/vagrant/curtisrc

- name: run swift list using curtisrc file
  shell: ". /home/vagrant/curtisrc; swift --insecure list"

- name: create a file to upload
  shell: chdir=/home/vagrant executable="/bin/bash" echo $RANDOM > swift.txt

- name: get md5sum of file
  command: chdir=/home/vagrant md5sum swift.txt
  register: md5sum_upload;

- name: upload a file into swift
  shell: chdir=/home/vagrant executable="/bin/bash" source ./curtisrc; swift --insecure upload swifty swift.txt

- name: remove swift.txt
  command: chdir=/home/vagrant rm -f ./swift.txt

- name: download file again
  shell: chdir=/home/vagrant executable="/bin/bash" source ./curtisrc; swift --insecure download swifty swift.txt